"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@hashbrownai+react@0.3.0_@hashbrownai+core@0.3.0_react-dom@18.3.1_react@18.3.1__react@18.3.1";
exports.ids = ["vendor-chunks/@hashbrownai+react@0.3.0_@hashbrownai+core@0.3.0_react-dom@18.3.1_react@18.3.1__react@18.3.1"];
exports.modules = {

/***/ "(ssr)/./node_modules/.pnpm/@hashbrownai+react@0.3.0_@hashbrownai+core@0.3.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/@hashbrownai/react/index.esm.js":
/*!**********************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@hashbrownai+react@0.3.0_@hashbrownai+core@0.3.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/@hashbrownai/react/index.esm.js ***!
  \**********************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   HashbrownProvider: () => (/* binding */ HashbrownProvider),\n/* harmony export */   exposeComponent: () => (/* binding */ exposeComponent),\n/* harmony export */   useChat: () => (/* binding */ useChat),\n/* harmony export */   useCompletion: () => (/* binding */ useCompletion),\n/* harmony export */   useRuntime: () => (/* binding */ useRuntime),\n/* harmony export */   useRuntimeFunction: () => (/* binding */ useRuntimeFunction),\n/* harmony export */   useStructuredChat: () => (/* binding */ useStructuredChat),\n/* harmony export */   useStructuredCompletion: () => (/* binding */ useStructuredCompletion),\n/* harmony export */   useTool: () => (/* binding */ useTool),\n/* harmony export */   useToolJavaScript: () => (/* binding */ useToolJavaScript),\n/* harmony export */   useUiChat: () => (/* binding */ useUiChat)\n/* harmony export */ });\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-runtime */ \"(ssr)/./node_modules/.pnpm/next@14.2.32_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react-jsx-runtime.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/.pnpm/next@14.2.32_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var _hashbrownai_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @hashbrownai/core */ \"(ssr)/./node_modules/.pnpm/@hashbrownai+core@0.3.0/node_modules/@hashbrownai/core/index.esm.js\");\n\n\n\n\n/**\n * Creates an object used to expose a component for use by the LLM.\n *\n * @example\n * ```ts\n * exposeComponent(\n *   CardComponent, // The React component to be exposed.\n *   { // The exposed component configuration.\n *     name: 'CardComponent',\n *     description: 'Show a card with children components to the user',\n *     children: 'any',\n *     props: {\n *       title: s.string('The title of the card'),\n *       description: s.streaming.string('The description of the card'),\n *     },\n *   },\n * });\n * ```\n *\n * @returns An object representing the component in order to expose it to the LLM.\n * @public\n */\nfunction exposeComponent(\n/**\n * The component to be exposed.\n */\ncomponent,\n/**\n * The configuration object for the component, excluding the component itself.\n */\nconfig) {\n  return Object.assign({\n    component\n  }, config);\n}\n\nconst HashbrownContext = /*#__PURE__*/(0,react__WEBPACK_IMPORTED_MODULE_1__.createContext)(undefined);\n/**\n * The context for the Hashbrown provider.  This is used to store the URL and middleware for contacting the Hashbrown endpoint.\n *\n * @public\n * @example\n * ```ts\n * <HashbrownProvider url=\"https://your.api.local/chat\">\n *   <App />\n * </HashbrownProvider>\n * ```\n */\nconst HashbrownProvider = (\n/**\n * The options for the Hashbrown provider.\n */\nprops) => {\n  const {\n    url,\n    middleware,\n    children\n  } = props;\n  return (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(HashbrownContext.Provider, {\n    value: {\n      url,\n      middleware\n    },\n    children: children\n  });\n};\n\n/**\n * Connects a Hashbrown Signal to React's reactivity system\n *\n * @param signal - The signal to connect to React\n * @returns The value contained in the signal\n */\nfunction useHashbrownSignal(signal) {\n  const lastValue = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(signal());\n  const hasSkippedFirstCall = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(false);\n  const equality = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((a, b) => (0,_hashbrownai_core__WEBPACK_IMPORTED_MODULE_2__[\"ɵdeepEqual\"])(a, b), []);\n  const read = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(() => {\n    const value = signal();\n    if (!equality(value, lastValue.current)) {\n      lastValue.current = value;\n    }\n    return lastValue.current;\n  }, [signal, equality]);\n  const subscribe = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(onStoreChange => {\n    let lastRead;\n    const cleanup = signal.subscribe(value => {\n      if (!hasSkippedFirstCall.current) {\n        hasSkippedFirstCall.current = true;\n        return;\n      }\n      const currentValue = read();\n      if (currentValue !== lastRead) {\n        lastRead = currentValue;\n        onStoreChange();\n      }\n    });\n    return () => {\n      cleanup();\n      hasSkippedFirstCall.current = false;\n    };\n  }, [signal, read]);\n  return (0,react__WEBPACK_IMPORTED_MODULE_1__.useSyncExternalStore)(subscribe, read);\n}\n\n/**\n * This React hook creates a chat instance used to interact with the LLM.\n * The result object contains functions and state enabling you to send and recieve messages and monitor the state of the chat.\n *\n * The `useChat` hook provides the most basic functionality for un-structured chats.  Unstructured chats include things like general chats and natural language controls.\n *\n * @public\n * @returns An object containing chat state and functions to interact with the chat.\n * @typeParam Tools - The set of tool definitions available to the chat.\n * @example\n * This example demonstrates how to use the `useChat` hook to create a simple chat component.\n *\n * ```tsx\n * const MyChatComponent = () => {\n *   const { messages, sendMessage, status } = useChat({\n *     model: 'gpt-4o',\n *     system: 'You are a helpful assistant.',\n *     tools: [],\n *   });\n *\n *   const handleSendMessage = () => {\n *     sendMessage({ role: 'user', content: 'Hello, how are you?' });\n *   };\n *\n *   return (\n *     <div>\n *       <button onClick={handleSendMessage}>Send Message</button>\n *       <div>Status: {status}</div>\n *       <ul>\n *         {messages.map((msg, index) => (\n *           <li key={index}>{msg.content}</li>\n *         ))}\n *       </ul>\n *     </div>\n *   );\n * };\n * ```\n */\nfunction useChat(\n/**\n * The options for the chat.\n */\noptions) {\n  var _a;\n  const tools = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => {\n    var _a;\n    return (_a = options.tools) !== null && _a !== void 0 ? _a : [];\n  },\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  (_a = options.tools) !== null && _a !== void 0 ? _a : []);\n  const config = (0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(HashbrownContext);\n  if (!config) {\n    throw new Error('HashbrownContext not found');\n  }\n  const hashbrownRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n  if (!hashbrownRef.current) {\n    hashbrownRef.current = (0,_hashbrownai_core__WEBPACK_IMPORTED_MODULE_2__.fryHashbrown)({\n      apiUrl: config.url,\n      middleware: config.middleware,\n      debugName: options.debugName,\n      model: options.model,\n      system: options.system,\n      tools,\n      debounce: options.debounceTime,\n      retries: options.retries\n    });\n  }\n  function getHashbrown() {\n    const instance = hashbrownRef.current;\n    if (!instance) {\n      throw new Error('Hashbrown not found');\n    }\n    return instance;\n  }\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    return getHashbrown().sizzle();\n  }, []);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    getHashbrown().updateOptions({\n      apiUrl: config.url,\n      middleware: config.middleware,\n      debugName: options.debugName,\n      model: options.model,\n      system: options.system,\n      tools,\n      debounce: options.debounceTime,\n      retries: options.retries\n    });\n  }, [config.url, config.middleware, options.debounceTime, options.debugName, options.model, options.retries, options.system, tools]);\n  const internalMessages = useHashbrownSignal(getHashbrown().messages);\n  const isReceiving = useHashbrownSignal(getHashbrown().isReceiving);\n  const isSending = useHashbrownSignal(getHashbrown().isSending);\n  const isRunningToolCalls = useHashbrownSignal(getHashbrown().isRunningToolCalls);\n  const exhaustedRetries = useHashbrownSignal(getHashbrown().exhaustedRetries);\n  const error = useHashbrownSignal(getHashbrown().error);\n  const lastAssistantMessage = useHashbrownSignal(getHashbrown().lastAssistantMessage);\n  const sendMessage = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(message => {\n    getHashbrown().sendMessage(message);\n  }, []);\n  const setMessages = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(messages => {\n    getHashbrown().setMessages(messages);\n  }, []);\n  const reload = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(() => {\n    const lastMessage = internalMessages[internalMessages.length - 1];\n    if (lastMessage.role === 'assistant') {\n      getHashbrown().setMessages(internalMessages.slice(0, -1));\n      return true;\n    }\n    return false;\n  }, [internalMessages]);\n  const stop = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((clearStreamingMessage = false) => {\n    getHashbrown().stop(clearStreamingMessage);\n  }, []);\n  return {\n    messages: internalMessages,\n    sendMessage,\n    setMessages,\n    stop,\n    reload,\n    error,\n    isReceiving,\n    isSending,\n    isRunningToolCalls,\n    exhaustedRetries,\n    lastAssistantMessage\n  };\n}\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\r\n\r\n\r\nfunction __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nfunction __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\ntypeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\r\n    var e = new Error(message);\r\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\r\n};\n\n/**\n * This React hook creates a change instance used to interact with the LLM.\n * The result object contains functions and state enabling you to send and recieve messages and monitor the state of the chat.\n *\n * @public\n * @remarks\n * The `useCompletion` hook provides functionality for completing unstructured inputs with predicted unstructured outputs.  This is useful for things like natural language autocompletions.\n *\n * @example\n * ```ts\n * const { output } = useCompletion({\n *   model: 'gpt-4o-mini',\n *   input: firstName,\n *   system: `Help the user generate a last name for the given first name.`,\n * });\n * ```\n */\nfunction useCompletion(\n/**\n * The options to configure the completion chat.\n */\noptions) {\n  const _a = useChat(Object.assign({}, options)),\n    {\n      setMessages\n    } = _a,\n    chat = __rest(_a, [\"setMessages\"]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (!options.input) return;\n    setMessages([{\n      role: 'user',\n      content: options.input\n    }]);\n  }, [setMessages, options.input]);\n  const output = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => {\n    const message = chat.messages.find(message => message.role === 'assistant' && !(message.toolCalls && message.toolCalls.length) && message.content);\n    if (!message) return null;\n    if (typeof message.content !== 'string') return null;\n    return message.content;\n  }, [chat.messages]);\n  return {\n    output,\n    reload: chat.reload,\n    error: chat.error,\n    isReceiving: chat.isReceiving,\n    isSending: chat.isSending,\n    isRunningToolCalls: chat.isRunningToolCalls,\n    exhaustedRetries: chat.exhaustedRetries\n  };\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * Creates a new runtime.\n *\n * @param options - The options for creating the runtime.\n * @returns A reference to the runtime.\n *\n * @public\n */\nfunction useRuntime(options) {\n  var _a;\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const functions = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => options.functions, (_a = options.functions) !== null && _a !== void 0 ? _a : []);\n  const runtime = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => (0,_hashbrownai_core__WEBPACK_IMPORTED_MODULE_2__[\"ɵcreateRuntimeImpl\"])({\n    functions,\n    timeout: options.timeout\n  }), [functions, options.timeout]);\n  return runtime;\n}\n\n/* eslint-disable no-redeclare */\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * @public\n */\nfunction useRuntimeFunction(cfg) {\n  const argsSchemaRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)('args' in cfg ? cfg.args : undefined);\n  const resultSchemaRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)('result' in cfg ? cfg.result : undefined);\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const handler = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(cfg.handler, cfg.deps);\n  const fn = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => {\n    return (0,_hashbrownai_core__WEBPACK_IMPORTED_MODULE_2__[\"ɵcreateRuntimeFunctionImpl\"])({\n      args: argsSchemaRef.current,\n      result: resultSchemaRef.current,\n      handler,\n      name: cfg.name,\n      description: cfg.description\n    });\n  }, [handler, cfg.name, cfg.description]);\n  return fn;\n}\n\n/**\n * This React hook creates a chat instance used to interact with the LLM.\n * The result object contains functions and state enabling you to send and receive messages and monitor the state of the chat.\n *\n * @public\n * @remarks\n * The `useStructuredChat` hook provides functionality for structured chats. Structured chats are used when you want to use the LLM to generate structured data according to a defined schema. This is particularly useful for:\n * - Generating typed data structures\n * - Creating form responses\n * - Building UI components\n * - Extracting information into a specific format\n *\n * @returns An object containing chat state and functions to interact with the chat.\n *\n * @example\n * In this example, the LLM will respond with a JSON object containing the translations of the input message into English, Spanish, and French.\n * ```tsx\n * const { messages, sendMessage } = useStructuredChat({\n *   model: 'gpt-4o',\n *   system: 'You are a helpful translator that provides accurate translations.',\n *   schema: s.object('Translations', {\n *     english: s.string('English translation'),\n *     spanish: s.string('Spanish translation'),\n *     french: s.string('French translation')\n *   }),\n * });\n * ```\n */\nfunction useStructuredChat(options) {\n  var _a;\n  const config = (0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(HashbrownContext);\n  if (!config) {\n    throw new Error('HashbrownContext not found');\n  }\n  const tools = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => {\n    var _a;\n    return (_a = options.tools) !== null && _a !== void 0 ? _a : [];\n  },\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  (_a = options.tools) !== null && _a !== void 0 ? _a : []);\n  const [schema] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(options.schema);\n  const hashbrown = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n  if (!hashbrown.current) {\n    hashbrown.current = (0,_hashbrownai_core__WEBPACK_IMPORTED_MODULE_2__.fryHashbrown)({\n      apiUrl: config.url,\n      middleware: config.middleware,\n      model: options.model,\n      system: options.system,\n      responseSchema: schema,\n      tools,\n      debugName: options.debugName,\n      debounce: options.debounceTime,\n      retries: options.retries\n    });\n  }\n  function getHashbrown() {\n    const instance = hashbrown.current;\n    if (!instance) {\n      throw new Error('Hashbrown not found');\n    }\n    return instance;\n  }\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    return getHashbrown().sizzle();\n  }, []);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    getHashbrown().updateOptions({\n      apiUrl: config.url,\n      middleware: config.middleware,\n      model: options.model,\n      system: options.system,\n      responseSchema: schema,\n      tools,\n      debugName: options.debugName,\n      debounce: options.debounceTime,\n      retries: options.retries\n    });\n  }, [config.url, config.middleware, options.model, options.system, options.debugName, schema, tools, options.debounceTime, options.retries]);\n  const internalMessages = useHashbrownSignal(hashbrown.current.messages);\n  const isReceiving = useHashbrownSignal(hashbrown.current.isReceiving);\n  const isSending = useHashbrownSignal(hashbrown.current.isSending);\n  const isRunningToolCalls = useHashbrownSignal(hashbrown.current.isRunningToolCalls);\n  const exhaustedRetries = useHashbrownSignal(hashbrown.current.exhaustedRetries);\n  const error = useHashbrownSignal(hashbrown.current.error);\n  const lastAssistantMessage = useHashbrownSignal(hashbrown.current.lastAssistantMessage);\n  const sendMessage = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(message => {\n    getHashbrown().sendMessage(message);\n  }, []);\n  const stop = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((clearStreamingMessage = false) => {\n    getHashbrown().stop(clearStreamingMessage);\n  }, []);\n  const resendMessages = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(() => {\n    getHashbrown().resendMessages();\n  }, []);\n  const setMessages = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(messages => {\n    getHashbrown().setMessages(messages);\n  }, []);\n  const reload = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(() => {\n    const lastMessage = internalMessages[internalMessages.length - 1];\n    if (lastMessage.role === 'assistant') {\n      getHashbrown().setMessages(internalMessages.slice(0, -1));\n      return true;\n    }\n    return false;\n  }, [internalMessages]);\n  return {\n    messages: internalMessages,\n    stop,\n    sendMessage,\n    resendMessages,\n    setMessages,\n    reload,\n    error,\n    isReceiving,\n    isSending,\n    isRunningToolCalls,\n    exhaustedRetries,\n    lastAssistantMessage\n  };\n}\n\n/**\n * This React hook creates a completion instance that predicts structured data based on input context.\n * The result object contains the predicted structured output and state for monitoring the completion.\n *\n * @public\n * @typeParam Input - The type of the input to predict from.\n * @typeParam Schema - The schema to use for the chat.\n * @remarks\n * The `useStructuredCompletion` hook provides functionality for predicting structured data based on input context. This is particularly useful for:\n * - Smart form field suggestions\n * - Context-aware recommendations\n * - Predictive UI generation\n * - Intelligent defaults\n *\n * @returns An object containing the predicted structured output and completion state.\n *\n * @example\n * In this example, the LLM will predict a color palette based on a given theme or mood.\n * ```tsx\n * const { output } = useStructuredCompletion({\n *   model: 'gpt-4o',\n *   system: `Predict a color palette based on the given mood or theme. For example,\n *   if the theme is \"Calm Ocean\", suggest appropriate colors.`,\n *   input: theme,\n *   schema: s.object('Color Palette', {\n *     colors: s.array(\n *       'The colors in the palette',\n *       s.string('Hex color code')\n *     )\n *   })\n * });\n * ```\n */\nfunction useStructuredCompletion(options) {\n  const _a = useStructuredChat(Object.assign({}, options)),\n    {\n      setMessages\n    } = _a,\n    chat = __rest(_a, [\"setMessages\"]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (!options.input) return;\n    setMessages([{\n      role: 'user',\n      content: options.input\n    }]);\n  }, [setMessages, options.input]);\n  const output = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => {\n    const message = chat.messages.find(message => message.role === 'assistant' && message.content);\n    if (!message) return null;\n    return message.content;\n  }, [chat.messages]);\n  return {\n    output,\n    reload: chat.reload,\n    error: chat.error,\n    isReceiving: chat.isReceiving,\n    isSending: chat.isSending,\n    isRunningToolCalls: chat.isRunningToolCalls,\n    exhaustedRetries: chat.exhaustedRetries\n  };\n}\n\n/* eslint no-redeclare: off */\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * @public\n */\nfunction useTool(input) {\n  const {\n    name,\n    description,\n    handler,\n    deps\n  } = input;\n  // assumes the schema will never change\n  const [schema] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)('schema' in input ? input.schema : _hashbrownai_core__WEBPACK_IMPORTED_MODULE_2__.s.object('Empty schema', {}));\n  // assumes the handler should only change if its deps change,\n  //   which enables the use of anonymous functions in the handler.\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const stableHandler = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(handler, deps);\n  const tool = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => {\n    return {\n      name,\n      description,\n      schema,\n      handler: stableHandler\n    };\n  }, [name, description, schema, stableHandler]);\n  return tool;\n}\n\n/**\n * Creates a tool that allows the LLM to run JavaScript code. It is run\n * in a stateful JavaScript environment, with no access to the internet, the DOM,\n * or any function that you have not explicitly defined.\n *\n * @public\n * @param options - The options for creating the tool.\n * @returns The tool.\n */\nfunction useToolJavaScript({\n  runtime\n}) {\n  return useTool({\n    name: 'javascript',\n    description: ['Whenever you send a message containing JavaScript code to javascript, it will be', 'executed in a stateful JavaScript environment. javascript will respond with the output', `of the execution or time out after ${runtime.timeout / 1000} seconds. Internet access`, 'for this session is disabled. Do not make external web requests or API calls as they', 'will fail.', '', 'Important: Prefer calling javascript once with a large amount of code, rather than calling it', 'multiple times with smaller amounts of code.', '', 'The following functions are available to you:', runtime.describe()].join('\\n'),\n    schema: _hashbrownai_core__WEBPACK_IMPORTED_MODULE_2__.s.streaming.object('The result', {\n      code: _hashbrownai_core__WEBPACK_IMPORTED_MODULE_2__.s.streaming.string('The JavaScript code to run')\n    }),\n    deps: [runtime],\n    handler: (_a, abortSignal_1) => __awaiter(this, [_a, abortSignal_1], void 0, function* ({\n      code\n    }, abortSignal) {\n      return runtime.run(code, abortSignal);\n    })\n  });\n}\n\n/**\n * This React hook creates a chat instance that can generate and render UI components.\n * The result object contains functions and state enabling you to send and receive messages and monitor the state of the chat.\n *\n * @public\n * @typeParam Tools - The set of tool definitions available to the chat.\n * @remarks\n * The `useUiChat` hook provides functionality for generating UI components through chat. This is particularly useful for:\n * - Dynamic UI generation\n * - Interactive chat interfaces\n * - Component-based responses\n * - Building chat-based UIs\n *\n * @returns An object containing chat state, functions to interact with the chat, and rendered UI components.\n *\n * @example\n * In this example, the LLM will respond with a UI component that can be rendered directly in your React application.\n * ```tsx\n * const { messages, sendMessage } = useUiChat({\n *   model: 'gpt-4o',\n *   system: 'You are a helpful assistant that can generate UI components.',\n *   components: [\n *     exposeComponent(Button, {\n *       name: 'Button',\n *       description: 'A clickable button component',\n *       props: {\n *         label: s.string('The text to display on the button'),\n *         onClick: s.function('Function to call when clicked')\n *       }\n *     })\n *   ]\n * });\n * ```\n */\nconst useUiChat = options => {\n  const {\n      components: initialComponents\n    } = options,\n    chatOptions = __rest(options, [\"components\"]);\n  const [components, setComponents] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(initialComponents);\n  const [flattenedComponents] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(_hashbrownai_core__WEBPACK_IMPORTED_MODULE_2__[\"ɵui\"].flattenComponents(initialComponents));\n  const ui = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => {\n    return _hashbrownai_core__WEBPACK_IMPORTED_MODULE_2__.s.object('UI', {\n      ui: _hashbrownai_core__WEBPACK_IMPORTED_MODULE_2__.s.streaming.array('List of elements', _hashbrownai_core__WEBPACK_IMPORTED_MODULE_2__[\"ɵui\"].createComponentSchema(components))\n    });\n  }, [components]);\n  const systemAsString = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => {\n    if (typeof chatOptions.system === 'string') {\n      return chatOptions.system;\n    }\n    const output = chatOptions.system.compile(components, ui);\n    if (chatOptions.system.diagnostics.length > 0) {\n      throw new Error(`System prompt has ${chatOptions.system.diagnostics.length} errors: \\n\\n${chatOptions.system.diagnostics.map(d => d.message).join('\\n\\n')}`);\n    }\n    return output;\n  }, [chatOptions.system, components, ui]);\n  const chat = useStructuredChat(Object.assign(Object.assign({}, chatOptions), {\n    schema: ui,\n    system: systemAsString\n  }));\n  const buildContent = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((nodes, parentKey = '') => {\n    if (typeof nodes === 'string') {\n      return nodes;\n    }\n    const elements = nodes.map((element, index) => {\n      var _a;\n      const key = `${parentKey}_${index}`;\n      const {\n        $tag,\n        $children,\n        $props\n      } = element;\n      const componentType = (_a = flattenedComponents.get($tag)) === null || _a === void 0 ? void 0 : _a.component;\n      if ($tag && componentType) {\n        const children = element.$children ? buildContent($children, key) : null;\n        return /*#__PURE__*/(0,react__WEBPACK_IMPORTED_MODULE_1__.createElement)(componentType, Object.assign(Object.assign({}, $props), {\n          children,\n          key\n        }));\n      }\n      throw new Error(`Unknown element type. ${$tag}`);\n    });\n    return elements;\n  }, [flattenedComponents]);\n  const uiChatMessages = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => {\n    return chat.messages.map(message => {\n      var _a;\n      if (message.role === 'assistant') {\n        return Object.assign(Object.assign({}, message), {\n          ui: ((_a = message.content) === null || _a === void 0 ? void 0 : _a.ui) ? buildContent(message.content.ui) : null\n        });\n      }\n      return message;\n    });\n  }, [buildContent, chat.messages]);\n  const lastAssistantMessage = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => {\n    return uiChatMessages.findLast(message => message.role === 'assistant');\n  }, [uiChatMessages]);\n  return Object.assign(Object.assign({}, chat), {\n    messages: uiChatMessages,\n    setComponents,\n    lastAssistantMessage\n  });\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQGhhc2hicm93bmFpK3JlYWN0QDAuMy4wX0BoYXNoYnJvd25haStjb3JlQDAuMy4wX3JlYWN0LWRvbUAxOC4zLjFfcmVhY3RAMTguMy4xX19yZWFjdEAxOC4zLjEvbm9kZV9tb2R1bGVzL0BoYXNoYnJvd25haS9yZWFjdC9pbmRleC5lc20uanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBd0M7QUFDa0c7QUFDb0Q7O0FBRTlMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUixNQUFNO0FBQ04sSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBLHNDQUFzQyxvREFBYTtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLFNBQVMsc0RBQUc7QUFDWjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsNkNBQU07QUFDMUIsOEJBQThCLDZDQUFNO0FBQ3BDLG1CQUFtQixrREFBVyxXQUFXLGdFQUFVO0FBQ25ELGVBQWUsa0RBQVc7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxvQkFBb0Isa0RBQVc7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFD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QkFBd0I7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLHNDQUFzQywrQ0FBUTtBQUM5QyxnQ0FBZ0MsK0NBQVEsQ0FBQyxxREFBRztBQUM1QyxhQUFhLDhDQUFPO0FBQ3BCLFdBQVcsZ0RBQUM7QUFDWixVQUFVLGdEQUFDLHFDQUFxQyxxREFBRztBQUNuRCxLQUFLO0FBQ0wsR0FBRztBQUNILHlCQUF5Qiw4Q0FBTztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLHVDQUF1QyxjQUFjLGdFQUFnRTtBQUNoSztBQUNBO0FBQ0EsR0FBRztBQUNILCtEQUErRDtBQUMvRDtBQUNBO0FBQ0EsR0FBRztBQUNILHVCQUF1QixrREFBVztBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLFVBQVUsR0FBRyxNQUFNO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixvREFBYSw4Q0FBOEM7QUFDdkY7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLCtDQUErQyxLQUFLO0FBQ3BELEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSCx5QkFBeUIsOENBQU87QUFDaEM7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDO0FBQzdDO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNILCtCQUErQiw4Q0FBTztBQUN0QztBQUNBLEdBQUc7QUFDSCx1Q0FBdUM7QUFDdkM7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUV5TCIsInNvdXJjZXMiOlsid2VicGFjazovL3RlYS1vbGl2ZS13ZWIvLi9ub2RlX21vZHVsZXMvLnBucG0vQGhhc2hicm93bmFpK3JlYWN0QDAuMy4wX0BoYXNoYnJvd25haStjb3JlQDAuMy4wX3JlYWN0LWRvbUAxOC4zLjFfcmVhY3RAMTguMy4xX19yZWFjdEAxOC4zLjEvbm9kZV9tb2R1bGVzL0BoYXNoYnJvd25haS9yZWFjdC9pbmRleC5lc20uanM/ZTIyOSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBqc3ggfSBmcm9tICdyZWFjdC9qc3gtcnVudGltZSc7XG5pbXBvcnQgeyBjcmVhdGVDb250ZXh0LCB1c2VSZWYsIHVzZUNhbGxiYWNrLCB1c2VTeW5jRXh0ZXJuYWxTdG9yZSwgdXNlTWVtbywgdXNlQ29udGV4dCwgdXNlRWZmZWN0LCB1c2VTdGF0ZSwgY3JlYXRlRWxlbWVudCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IMm1ZGVlcEVxdWFsIGFzIF9kZWVwRXF1YWwsIGZyeUhhc2hicm93biwgybVjcmVhdGVSdW50aW1lSW1wbCBhcyBfY3JlYXRlUnVudGltZUltcGwsIMm1Y3JlYXRlUnVudGltZUZ1bmN0aW9uSW1wbCBhcyBfY3JlYXRlUnVudGltZUZ1bmN0aW9uSW1wbCwgcywgybV1aSBhcyBfdWkgfSBmcm9tICdAaGFzaGJyb3duYWkvY29yZSc7XG5cbi8qKlxuICogQ3JlYXRlcyBhbiBvYmplY3QgdXNlZCB0byBleHBvc2UgYSBjb21wb25lbnQgZm9yIHVzZSBieSB0aGUgTExNLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogZXhwb3NlQ29tcG9uZW50KFxuICogICBDYXJkQ29tcG9uZW50LCAvLyBUaGUgUmVhY3QgY29tcG9uZW50IHRvIGJlIGV4cG9zZWQuXG4gKiAgIHsgLy8gVGhlIGV4cG9zZWQgY29tcG9uZW50IGNvbmZpZ3VyYXRpb24uXG4gKiAgICAgbmFtZTogJ0NhcmRDb21wb25lbnQnLFxuICogICAgIGRlc2NyaXB0aW9uOiAnU2hvdyBhIGNhcmQgd2l0aCBjaGlsZHJlbiBjb21wb25lbnRzIHRvIHRoZSB1c2VyJyxcbiAqICAgICBjaGlsZHJlbjogJ2FueScsXG4gKiAgICAgcHJvcHM6IHtcbiAqICAgICAgIHRpdGxlOiBzLnN0cmluZygnVGhlIHRpdGxlIG9mIHRoZSBjYXJkJyksXG4gKiAgICAgICBkZXNjcmlwdGlvbjogcy5zdHJlYW1pbmcuc3RyaW5nKCdUaGUgZGVzY3JpcHRpb24gb2YgdGhlIGNhcmQnKSxcbiAqICAgICB9LFxuICogICB9LFxuICogfSk7XG4gKiBgYGBcbiAqXG4gKiBAcmV0dXJucyBBbiBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBjb21wb25lbnQgaW4gb3JkZXIgdG8gZXhwb3NlIGl0IHRvIHRoZSBMTE0uXG4gKiBAcHVibGljXG4gKi9cbmZ1bmN0aW9uIGV4cG9zZUNvbXBvbmVudChcbi8qKlxuICogVGhlIGNvbXBvbmVudCB0byBiZSBleHBvc2VkLlxuICovXG5jb21wb25lbnQsXG4vKipcbiAqIFRoZSBjb25maWd1cmF0aW9uIG9iamVjdCBmb3IgdGhlIGNvbXBvbmVudCwgZXhjbHVkaW5nIHRoZSBjb21wb25lbnQgaXRzZWxmLlxuICovXG5jb25maWcpIHtcbiAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe1xuICAgIGNvbXBvbmVudFxuICB9LCBjb25maWcpO1xufVxuXG5jb25zdCBIYXNoYnJvd25Db250ZXh0ID0gLyojX19QVVJFX18qL2NyZWF0ZUNvbnRleHQodW5kZWZpbmVkKTtcbi8qKlxuICogVGhlIGNvbnRleHQgZm9yIHRoZSBIYXNoYnJvd24gcHJvdmlkZXIuICBUaGlzIGlzIHVzZWQgdG8gc3RvcmUgdGhlIFVSTCBhbmQgbWlkZGxld2FyZSBmb3IgY29udGFjdGluZyB0aGUgSGFzaGJyb3duIGVuZHBvaW50LlxuICpcbiAqIEBwdWJsaWNcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogPEhhc2hicm93blByb3ZpZGVyIHVybD1cImh0dHBzOi8veW91ci5hcGkubG9jYWwvY2hhdFwiPlxuICogICA8QXBwIC8+XG4gKiA8L0hhc2hicm93blByb3ZpZGVyPlxuICogYGBgXG4gKi9cbmNvbnN0IEhhc2hicm93blByb3ZpZGVyID0gKFxuLyoqXG4gKiBUaGUgb3B0aW9ucyBmb3IgdGhlIEhhc2hicm93biBwcm92aWRlci5cbiAqL1xucHJvcHMpID0+IHtcbiAgY29uc3Qge1xuICAgIHVybCxcbiAgICBtaWRkbGV3YXJlLFxuICAgIGNoaWxkcmVuXG4gIH0gPSBwcm9wcztcbiAgcmV0dXJuIGpzeChIYXNoYnJvd25Db250ZXh0LlByb3ZpZGVyLCB7XG4gICAgdmFsdWU6IHtcbiAgICAgIHVybCxcbiAgICAgIG1pZGRsZXdhcmVcbiAgICB9LFxuICAgIGNoaWxkcmVuOiBjaGlsZHJlblxuICB9KTtcbn07XG5cbi8qKlxuICogQ29ubmVjdHMgYSBIYXNoYnJvd24gU2lnbmFsIHRvIFJlYWN0J3MgcmVhY3Rpdml0eSBzeXN0ZW1cbiAqXG4gKiBAcGFyYW0gc2lnbmFsIC0gVGhlIHNpZ25hbCB0byBjb25uZWN0IHRvIFJlYWN0XG4gKiBAcmV0dXJucyBUaGUgdmFsdWUgY29udGFpbmVkIGluIHRoZSBzaWduYWxcbiAqL1xuZnVuY3Rpb24gdXNlSGFzaGJyb3duU2lnbmFsKHNpZ25hbCkge1xuICBjb25zdCBsYXN0VmFsdWUgPSB1c2VSZWYoc2lnbmFsKCkpO1xuICBjb25zdCBoYXNTa2lwcGVkRmlyc3RDYWxsID0gdXNlUmVmKGZhbHNlKTtcbiAgY29uc3QgZXF1YWxpdHkgPSB1c2VDYWxsYmFjaygoYSwgYikgPT4gX2RlZXBFcXVhbChhLCBiKSwgW10pO1xuICBjb25zdCByZWFkID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIGNvbnN0IHZhbHVlID0gc2lnbmFsKCk7XG4gICAgaWYgKCFlcXVhbGl0eSh2YWx1ZSwgbGFzdFZhbHVlLmN1cnJlbnQpKSB7XG4gICAgICBsYXN0VmFsdWUuY3VycmVudCA9IHZhbHVlO1xuICAgIH1cbiAgICByZXR1cm4gbGFzdFZhbHVlLmN1cnJlbnQ7XG4gIH0sIFtzaWduYWwsIGVxdWFsaXR5XSk7XG4gIGNvbnN0IHN1YnNjcmliZSA9IHVzZUNhbGxiYWNrKG9uU3RvcmVDaGFuZ2UgPT4ge1xuICAgIGxldCBsYXN0UmVhZDtcbiAgICBjb25zdCBjbGVhbnVwID0gc2lnbmFsLnN1YnNjcmliZSh2YWx1ZSA9PiB7XG4gICAgICBpZiAoIWhhc1NraXBwZWRGaXJzdENhbGwuY3VycmVudCkge1xuICAgICAgICBoYXNTa2lwcGVkRmlyc3RDYWxsLmN1cnJlbnQgPSB0cnVlO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCBjdXJyZW50VmFsdWUgPSByZWFkKCk7XG4gICAgICBpZiAoY3VycmVudFZhbHVlICE9PSBsYXN0UmVhZCkge1xuICAgICAgICBsYXN0UmVhZCA9IGN1cnJlbnRWYWx1ZTtcbiAgICAgICAgb25TdG9yZUNoYW5nZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBjbGVhbnVwKCk7XG4gICAgICBoYXNTa2lwcGVkRmlyc3RDYWxsLmN1cnJlbnQgPSBmYWxzZTtcbiAgICB9O1xuICB9LCBbc2lnbmFsLCByZWFkXSk7XG4gIHJldHVybiB1c2VTeW5jRXh0ZXJuYWxTdG9yZShzdWJzY3JpYmUsIHJlYWQpO1xufVxuXG4vKipcbiAqIFRoaXMgUmVhY3QgaG9vayBjcmVhdGVzIGEgY2hhdCBpbnN0YW5jZSB1c2VkIHRvIGludGVyYWN0IHdpdGggdGhlIExMTS5cbiAqIFRoZSByZXN1bHQgb2JqZWN0IGNvbnRhaW5zIGZ1bmN0aW9ucyBhbmQgc3RhdGUgZW5hYmxpbmcgeW91IHRvIHNlbmQgYW5kIHJlY2lldmUgbWVzc2FnZXMgYW5kIG1vbml0b3IgdGhlIHN0YXRlIG9mIHRoZSBjaGF0LlxuICpcbiAqIFRoZSBgdXNlQ2hhdGAgaG9vayBwcm92aWRlcyB0aGUgbW9zdCBiYXNpYyBmdW5jdGlvbmFsaXR5IGZvciB1bi1zdHJ1Y3R1cmVkIGNoYXRzLiAgVW5zdHJ1Y3R1cmVkIGNoYXRzIGluY2x1ZGUgdGhpbmdzIGxpa2UgZ2VuZXJhbCBjaGF0cyBhbmQgbmF0dXJhbCBsYW5ndWFnZSBjb250cm9scy5cbiAqXG4gKiBAcHVibGljXG4gKiBAcmV0dXJucyBBbiBvYmplY3QgY29udGFpbmluZyBjaGF0IHN0YXRlIGFuZCBmdW5jdGlvbnMgdG8gaW50ZXJhY3Qgd2l0aCB0aGUgY2hhdC5cbiAqIEB0eXBlUGFyYW0gVG9vbHMgLSBUaGUgc2V0IG9mIHRvb2wgZGVmaW5pdGlvbnMgYXZhaWxhYmxlIHRvIHRoZSBjaGF0LlxuICogQGV4YW1wbGVcbiAqIFRoaXMgZXhhbXBsZSBkZW1vbnN0cmF0ZXMgaG93IHRvIHVzZSB0aGUgYHVzZUNoYXRgIGhvb2sgdG8gY3JlYXRlIGEgc2ltcGxlIGNoYXQgY29tcG9uZW50LlxuICpcbiAqIGBgYHRzeFxuICogY29uc3QgTXlDaGF0Q29tcG9uZW50ID0gKCkgPT4ge1xuICogICBjb25zdCB7IG1lc3NhZ2VzLCBzZW5kTWVzc2FnZSwgc3RhdHVzIH0gPSB1c2VDaGF0KHtcbiAqICAgICBtb2RlbDogJ2dwdC00bycsXG4gKiAgICAgc3lzdGVtOiAnWW91IGFyZSBhIGhlbHBmdWwgYXNzaXN0YW50LicsXG4gKiAgICAgdG9vbHM6IFtdLFxuICogICB9KTtcbiAqXG4gKiAgIGNvbnN0IGhhbmRsZVNlbmRNZXNzYWdlID0gKCkgPT4ge1xuICogICAgIHNlbmRNZXNzYWdlKHsgcm9sZTogJ3VzZXInLCBjb250ZW50OiAnSGVsbG8sIGhvdyBhcmUgeW91PycgfSk7XG4gKiAgIH07XG4gKlxuICogICByZXR1cm4gKFxuICogICAgIDxkaXY+XG4gKiAgICAgICA8YnV0dG9uIG9uQ2xpY2s9e2hhbmRsZVNlbmRNZXNzYWdlfT5TZW5kIE1lc3NhZ2U8L2J1dHRvbj5cbiAqICAgICAgIDxkaXY+U3RhdHVzOiB7c3RhdHVzfTwvZGl2PlxuICogICAgICAgPHVsPlxuICogICAgICAgICB7bWVzc2FnZXMubWFwKChtc2csIGluZGV4KSA9PiAoXG4gKiAgICAgICAgICAgPGxpIGtleT17aW5kZXh9Pnttc2cuY29udGVudH08L2xpPlxuICogICAgICAgICApKX1cbiAqICAgICAgIDwvdWw+XG4gKiAgICAgPC9kaXY+XG4gKiAgICk7XG4gKiB9O1xuICogYGBgXG4gKi9cbmZ1bmN0aW9uIHVzZUNoYXQoXG4vKipcbiAqIFRoZSBvcHRpb25zIGZvciB0aGUgY2hhdC5cbiAqL1xub3B0aW9ucykge1xuICB2YXIgX2E7XG4gIGNvbnN0IHRvb2xzID0gdXNlTWVtbygoKSA9PiB7XG4gICAgdmFyIF9hO1xuICAgIHJldHVybiAoX2EgPSBvcHRpb25zLnRvb2xzKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiBbXTtcbiAgfSxcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWhvb2tzL2V4aGF1c3RpdmUtZGVwc1xuICAoX2EgPSBvcHRpb25zLnRvb2xzKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiBbXSk7XG4gIGNvbnN0IGNvbmZpZyA9IHVzZUNvbnRleHQoSGFzaGJyb3duQ29udGV4dCk7XG4gIGlmICghY29uZmlnKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdIYXNoYnJvd25Db250ZXh0IG5vdCBmb3VuZCcpO1xuICB9XG4gIGNvbnN0IGhhc2hicm93blJlZiA9IHVzZVJlZihudWxsKTtcbiAgaWYgKCFoYXNoYnJvd25SZWYuY3VycmVudCkge1xuICAgIGhhc2hicm93blJlZi5jdXJyZW50ID0gZnJ5SGFzaGJyb3duKHtcbiAgICAgIGFwaVVybDogY29uZmlnLnVybCxcbiAgICAgIG1pZGRsZXdhcmU6IGNvbmZpZy5taWRkbGV3YXJlLFxuICAgICAgZGVidWdOYW1lOiBvcHRpb25zLmRlYnVnTmFtZSxcbiAgICAgIG1vZGVsOiBvcHRpb25zLm1vZGVsLFxuICAgICAgc3lzdGVtOiBvcHRpb25zLnN5c3RlbSxcbiAgICAgIHRvb2xzLFxuICAgICAgZGVib3VuY2U6IG9wdGlvbnMuZGVib3VuY2VUaW1lLFxuICAgICAgcmV0cmllczogb3B0aW9ucy5yZXRyaWVzXG4gICAgfSk7XG4gIH1cbiAgZnVuY3Rpb24gZ2V0SGFzaGJyb3duKCkge1xuICAgIGNvbnN0IGluc3RhbmNlID0gaGFzaGJyb3duUmVmLmN1cnJlbnQ7XG4gICAgaWYgKCFpbnN0YW5jZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdIYXNoYnJvd24gbm90IGZvdW5kJyk7XG4gICAgfVxuICAgIHJldHVybiBpbnN0YW5jZTtcbiAgfVxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIHJldHVybiBnZXRIYXNoYnJvd24oKS5zaXp6bGUoKTtcbiAgfSwgW10pO1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGdldEhhc2hicm93bigpLnVwZGF0ZU9wdGlvbnMoe1xuICAgICAgYXBpVXJsOiBjb25maWcudXJsLFxuICAgICAgbWlkZGxld2FyZTogY29uZmlnLm1pZGRsZXdhcmUsXG4gICAgICBkZWJ1Z05hbWU6IG9wdGlvbnMuZGVidWdOYW1lLFxuICAgICAgbW9kZWw6IG9wdGlvbnMubW9kZWwsXG4gICAgICBzeXN0ZW06IG9wdGlvbnMuc3lzdGVtLFxuICAgICAgdG9vbHMsXG4gICAgICBkZWJvdW5jZTogb3B0aW9ucy5kZWJvdW5jZVRpbWUsXG4gICAgICByZXRyaWVzOiBvcHRpb25zLnJldHJpZXNcbiAgICB9KTtcbiAgfSwgW2NvbmZpZy51cmwsIGNvbmZpZy5taWRkbGV3YXJlLCBvcHRpb25zLmRlYm91bmNlVGltZSwgb3B0aW9ucy5kZWJ1Z05hbWUsIG9wdGlvbnMubW9kZWwsIG9wdGlvbnMucmV0cmllcywgb3B0aW9ucy5zeXN0ZW0sIHRvb2xzXSk7XG4gIGNvbnN0IGludGVybmFsTWVzc2FnZXMgPSB1c2VIYXNoYnJvd25TaWduYWwoZ2V0SGFzaGJyb3duKCkubWVzc2FnZXMpO1xuICBjb25zdCBpc1JlY2VpdmluZyA9IHVzZUhhc2hicm93blNpZ25hbChnZXRIYXNoYnJvd24oKS5pc1JlY2VpdmluZyk7XG4gIGNvbnN0IGlzU2VuZGluZyA9IHVzZUhhc2hicm93blNpZ25hbChnZXRIYXNoYnJvd24oKS5pc1NlbmRpbmcpO1xuICBjb25zdCBpc1J1bm5pbmdUb29sQ2FsbHMgPSB1c2VIYXNoYnJvd25TaWduYWwoZ2V0SGFzaGJyb3duKCkuaXNSdW5uaW5nVG9vbENhbGxzKTtcbiAgY29uc3QgZXhoYXVzdGVkUmV0cmllcyA9IHVzZUhhc2hicm93blNpZ25hbChnZXRIYXNoYnJvd24oKS5leGhhdXN0ZWRSZXRyaWVzKTtcbiAgY29uc3QgZXJyb3IgPSB1c2VIYXNoYnJvd25TaWduYWwoZ2V0SGFzaGJyb3duKCkuZXJyb3IpO1xuICBjb25zdCBsYXN0QXNzaXN0YW50TWVzc2FnZSA9IHVzZUhhc2hicm93blNpZ25hbChnZXRIYXNoYnJvd24oKS5sYXN0QXNzaXN0YW50TWVzc2FnZSk7XG4gIGNvbnN0IHNlbmRNZXNzYWdlID0gdXNlQ2FsbGJhY2sobWVzc2FnZSA9PiB7XG4gICAgZ2V0SGFzaGJyb3duKCkuc2VuZE1lc3NhZ2UobWVzc2FnZSk7XG4gIH0sIFtdKTtcbiAgY29uc3Qgc2V0TWVzc2FnZXMgPSB1c2VDYWxsYmFjayhtZXNzYWdlcyA9PiB7XG4gICAgZ2V0SGFzaGJyb3duKCkuc2V0TWVzc2FnZXMobWVzc2FnZXMpO1xuICB9LCBbXSk7XG4gIGNvbnN0IHJlbG9hZCA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBjb25zdCBsYXN0TWVzc2FnZSA9IGludGVybmFsTWVzc2FnZXNbaW50ZXJuYWxNZXNzYWdlcy5sZW5ndGggLSAxXTtcbiAgICBpZiAobGFzdE1lc3NhZ2Uucm9sZSA9PT0gJ2Fzc2lzdGFudCcpIHtcbiAgICAgIGdldEhhc2hicm93bigpLnNldE1lc3NhZ2VzKGludGVybmFsTWVzc2FnZXMuc2xpY2UoMCwgLTEpKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH0sIFtpbnRlcm5hbE1lc3NhZ2VzXSk7XG4gIGNvbnN0IHN0b3AgPSB1c2VDYWxsYmFjaygoY2xlYXJTdHJlYW1pbmdNZXNzYWdlID0gZmFsc2UpID0+IHtcbiAgICBnZXRIYXNoYnJvd24oKS5zdG9wKGNsZWFyU3RyZWFtaW5nTWVzc2FnZSk7XG4gIH0sIFtdKTtcbiAgcmV0dXJuIHtcbiAgICBtZXNzYWdlczogaW50ZXJuYWxNZXNzYWdlcyxcbiAgICBzZW5kTWVzc2FnZSxcbiAgICBzZXRNZXNzYWdlcyxcbiAgICBzdG9wLFxuICAgIHJlbG9hZCxcbiAgICBlcnJvcixcbiAgICBpc1JlY2VpdmluZyxcbiAgICBpc1NlbmRpbmcsXG4gICAgaXNSdW5uaW5nVG9vbENhbGxzLFxuICAgIGV4aGF1c3RlZFJldHJpZXMsXG4gICAgbGFzdEFzc2lzdGFudE1lc3NhZ2VcbiAgfTtcbn1cblxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi5cclxuXHJcblBlcm1pc3Npb24gdG8gdXNlLCBjb3B5LCBtb2RpZnksIGFuZC9vciBkaXN0cmlidXRlIHRoaXMgc29mdHdhcmUgZm9yIGFueVxyXG5wdXJwb3NlIHdpdGggb3Igd2l0aG91dCBmZWUgaXMgaGVyZWJ5IGdyYW50ZWQuXHJcblxyXG5USEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiIEFORCBUSEUgQVVUSE9SIERJU0NMQUlNUyBBTEwgV0FSUkFOVElFUyBXSVRIXHJcblJFR0FSRCBUTyBUSElTIFNPRlRXQVJFIElOQ0xVRElORyBBTEwgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWVxyXG5BTkQgRklUTkVTUy4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgRk9SIEFOWSBTUEVDSUFMLCBESVJFQ1QsXHJcbklORElSRUNULCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgT1IgQU5ZIERBTUFHRVMgV0hBVFNPRVZFUiBSRVNVTFRJTkcgRlJPTVxyXG5MT1NTIE9GIFVTRSwgREFUQSBPUiBQUk9GSVRTLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUlxyXG5PVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SXHJcblBFUkZPUk1BTkNFIE9GIFRISVMgU09GVFdBUkUuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcbi8qIGdsb2JhbCBSZWZsZWN0LCBQcm9taXNlLCBTdXBwcmVzc2VkRXJyb3IsIFN5bWJvbCwgSXRlcmF0b3IgKi9cclxuXHJcblxyXG5mdW5jdGlvbiBfX3Jlc3QocywgZSkge1xyXG4gICAgdmFyIHQgPSB7fTtcclxuICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxyXG4gICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKGUuaW5kZXhPZihwW2ldKSA8IDAgJiYgT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKHMsIHBbaV0pKVxyXG4gICAgICAgICAgICAgICAgdFtwW2ldXSA9IHNbcFtpXV07XHJcbiAgICAgICAgfVxyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbnR5cGVvZiBTdXBwcmVzc2VkRXJyb3IgPT09IFwiZnVuY3Rpb25cIiA/IFN1cHByZXNzZWRFcnJvciA6IGZ1bmN0aW9uIChlcnJvciwgc3VwcHJlc3NlZCwgbWVzc2FnZSkge1xyXG4gICAgdmFyIGUgPSBuZXcgRXJyb3IobWVzc2FnZSk7XHJcbiAgICByZXR1cm4gZS5uYW1lID0gXCJTdXBwcmVzc2VkRXJyb3JcIiwgZS5lcnJvciA9IGVycm9yLCBlLnN1cHByZXNzZWQgPSBzdXBwcmVzc2VkLCBlO1xyXG59O1xuXG4vKipcbiAqIFRoaXMgUmVhY3QgaG9vayBjcmVhdGVzIGEgY2hhbmdlIGluc3RhbmNlIHVzZWQgdG8gaW50ZXJhY3Qgd2l0aCB0aGUgTExNLlxuICogVGhlIHJlc3VsdCBvYmplY3QgY29udGFpbnMgZnVuY3Rpb25zIGFuZCBzdGF0ZSBlbmFibGluZyB5b3UgdG8gc2VuZCBhbmQgcmVjaWV2ZSBtZXNzYWdlcyBhbmQgbW9uaXRvciB0aGUgc3RhdGUgb2YgdGhlIGNoYXQuXG4gKlxuICogQHB1YmxpY1xuICogQHJlbWFya3NcbiAqIFRoZSBgdXNlQ29tcGxldGlvbmAgaG9vayBwcm92aWRlcyBmdW5jdGlvbmFsaXR5IGZvciBjb21wbGV0aW5nIHVuc3RydWN0dXJlZCBpbnB1dHMgd2l0aCBwcmVkaWN0ZWQgdW5zdHJ1Y3R1cmVkIG91dHB1dHMuICBUaGlzIGlzIHVzZWZ1bCBmb3IgdGhpbmdzIGxpa2UgbmF0dXJhbCBsYW5ndWFnZSBhdXRvY29tcGxldGlvbnMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzXG4gKiBjb25zdCB7IG91dHB1dCB9ID0gdXNlQ29tcGxldGlvbih7XG4gKiAgIG1vZGVsOiAnZ3B0LTRvLW1pbmknLFxuICogICBpbnB1dDogZmlyc3ROYW1lLFxuICogICBzeXN0ZW06IGBIZWxwIHRoZSB1c2VyIGdlbmVyYXRlIGEgbGFzdCBuYW1lIGZvciB0aGUgZ2l2ZW4gZmlyc3QgbmFtZS5gLFxuICogfSk7XG4gKiBgYGBcbiAqL1xuZnVuY3Rpb24gdXNlQ29tcGxldGlvbihcbi8qKlxuICogVGhlIG9wdGlvbnMgdG8gY29uZmlndXJlIHRoZSBjb21wbGV0aW9uIGNoYXQuXG4gKi9cbm9wdGlvbnMpIHtcbiAgY29uc3QgX2EgPSB1c2VDaGF0KE9iamVjdC5hc3NpZ24oe30sIG9wdGlvbnMpKSxcbiAgICB7XG4gICAgICBzZXRNZXNzYWdlc1xuICAgIH0gPSBfYSxcbiAgICBjaGF0ID0gX19yZXN0KF9hLCBbXCJzZXRNZXNzYWdlc1wiXSk7XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKCFvcHRpb25zLmlucHV0KSByZXR1cm47XG4gICAgc2V0TWVzc2FnZXMoW3tcbiAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgIGNvbnRlbnQ6IG9wdGlvbnMuaW5wdXRcbiAgICB9XSk7XG4gIH0sIFtzZXRNZXNzYWdlcywgb3B0aW9ucy5pbnB1dF0pO1xuICBjb25zdCBvdXRwdXQgPSB1c2VNZW1vKCgpID0+IHtcbiAgICBjb25zdCBtZXNzYWdlID0gY2hhdC5tZXNzYWdlcy5maW5kKG1lc3NhZ2UgPT4gbWVzc2FnZS5yb2xlID09PSAnYXNzaXN0YW50JyAmJiAhKG1lc3NhZ2UudG9vbENhbGxzICYmIG1lc3NhZ2UudG9vbENhbGxzLmxlbmd0aCkgJiYgbWVzc2FnZS5jb250ZW50KTtcbiAgICBpZiAoIW1lc3NhZ2UpIHJldHVybiBudWxsO1xuICAgIGlmICh0eXBlb2YgbWVzc2FnZS5jb250ZW50ICE9PSAnc3RyaW5nJykgcmV0dXJuIG51bGw7XG4gICAgcmV0dXJuIG1lc3NhZ2UuY29udGVudDtcbiAgfSwgW2NoYXQubWVzc2FnZXNdKTtcbiAgcmV0dXJuIHtcbiAgICBvdXRwdXQsXG4gICAgcmVsb2FkOiBjaGF0LnJlbG9hZCxcbiAgICBlcnJvcjogY2hhdC5lcnJvcixcbiAgICBpc1JlY2VpdmluZzogY2hhdC5pc1JlY2VpdmluZyxcbiAgICBpc1NlbmRpbmc6IGNoYXQuaXNTZW5kaW5nLFxuICAgIGlzUnVubmluZ1Rvb2xDYWxsczogY2hhdC5pc1J1bm5pbmdUb29sQ2FsbHMsXG4gICAgZXhoYXVzdGVkUmV0cmllczogY2hhdC5leGhhdXN0ZWRSZXRyaWVzXG4gIH07XG59XG5cbi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnkgKi9cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyBydW50aW1lLlxuICpcbiAqIEBwYXJhbSBvcHRpb25zIC0gVGhlIG9wdGlvbnMgZm9yIGNyZWF0aW5nIHRoZSBydW50aW1lLlxuICogQHJldHVybnMgQSByZWZlcmVuY2UgdG8gdGhlIHJ1bnRpbWUuXG4gKlxuICogQHB1YmxpY1xuICovXG5mdW5jdGlvbiB1c2VSdW50aW1lKG9wdGlvbnMpIHtcbiAgdmFyIF9hO1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvZXhoYXVzdGl2ZS1kZXBzXG4gIGNvbnN0IGZ1bmN0aW9ucyA9IHVzZU1lbW8oKCkgPT4gb3B0aW9ucy5mdW5jdGlvbnMsIChfYSA9IG9wdGlvbnMuZnVuY3Rpb25zKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiBbXSk7XG4gIGNvbnN0IHJ1bnRpbWUgPSB1c2VNZW1vKCgpID0+IF9jcmVhdGVSdW50aW1lSW1wbCh7XG4gICAgZnVuY3Rpb25zLFxuICAgIHRpbWVvdXQ6IG9wdGlvbnMudGltZW91dFxuICB9KSwgW2Z1bmN0aW9ucywgb3B0aW9ucy50aW1lb3V0XSk7XG4gIHJldHVybiBydW50aW1lO1xufVxuXG4vKiBlc2xpbnQtZGlzYWJsZSBuby1yZWRlY2xhcmUgKi9cbi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnkgKi9cbi8qKlxuICogQHB1YmxpY1xuICovXG5mdW5jdGlvbiB1c2VSdW50aW1lRnVuY3Rpb24oY2ZnKSB7XG4gIGNvbnN0IGFyZ3NTY2hlbWFSZWYgPSB1c2VSZWYoJ2FyZ3MnIGluIGNmZyA/IGNmZy5hcmdzIDogdW5kZWZpbmVkKTtcbiAgY29uc3QgcmVzdWx0U2NoZW1hUmVmID0gdXNlUmVmKCdyZXN1bHQnIGluIGNmZyA/IGNmZy5yZXN1bHQgOiB1bmRlZmluZWQpO1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvZXhoYXVzdGl2ZS1kZXBzXG4gIGNvbnN0IGhhbmRsZXIgPSB1c2VDYWxsYmFjayhjZmcuaGFuZGxlciwgY2ZnLmRlcHMpO1xuICBjb25zdCBmbiA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIHJldHVybiBfY3JlYXRlUnVudGltZUZ1bmN0aW9uSW1wbCh7XG4gICAgICBhcmdzOiBhcmdzU2NoZW1hUmVmLmN1cnJlbnQsXG4gICAgICByZXN1bHQ6IHJlc3VsdFNjaGVtYVJlZi5jdXJyZW50LFxuICAgICAgaGFuZGxlcixcbiAgICAgIG5hbWU6IGNmZy5uYW1lLFxuICAgICAgZGVzY3JpcHRpb246IGNmZy5kZXNjcmlwdGlvblxuICAgIH0pO1xuICB9LCBbaGFuZGxlciwgY2ZnLm5hbWUsIGNmZy5kZXNjcmlwdGlvbl0pO1xuICByZXR1cm4gZm47XG59XG5cbi8qKlxuICogVGhpcyBSZWFjdCBob29rIGNyZWF0ZXMgYSBjaGF0IGluc3RhbmNlIHVzZWQgdG8gaW50ZXJhY3Qgd2l0aCB0aGUgTExNLlxuICogVGhlIHJlc3VsdCBvYmplY3QgY29udGFpbnMgZnVuY3Rpb25zIGFuZCBzdGF0ZSBlbmFibGluZyB5b3UgdG8gc2VuZCBhbmQgcmVjZWl2ZSBtZXNzYWdlcyBhbmQgbW9uaXRvciB0aGUgc3RhdGUgb2YgdGhlIGNoYXQuXG4gKlxuICogQHB1YmxpY1xuICogQHJlbWFya3NcbiAqIFRoZSBgdXNlU3RydWN0dXJlZENoYXRgIGhvb2sgcHJvdmlkZXMgZnVuY3Rpb25hbGl0eSBmb3Igc3RydWN0dXJlZCBjaGF0cy4gU3RydWN0dXJlZCBjaGF0cyBhcmUgdXNlZCB3aGVuIHlvdSB3YW50IHRvIHVzZSB0aGUgTExNIHRvIGdlbmVyYXRlIHN0cnVjdHVyZWQgZGF0YSBhY2NvcmRpbmcgdG8gYSBkZWZpbmVkIHNjaGVtYS4gVGhpcyBpcyBwYXJ0aWN1bGFybHkgdXNlZnVsIGZvcjpcbiAqIC0gR2VuZXJhdGluZyB0eXBlZCBkYXRhIHN0cnVjdHVyZXNcbiAqIC0gQ3JlYXRpbmcgZm9ybSByZXNwb25zZXNcbiAqIC0gQnVpbGRpbmcgVUkgY29tcG9uZW50c1xuICogLSBFeHRyYWN0aW5nIGluZm9ybWF0aW9uIGludG8gYSBzcGVjaWZpYyBmb3JtYXRcbiAqXG4gKiBAcmV0dXJucyBBbiBvYmplY3QgY29udGFpbmluZyBjaGF0IHN0YXRlIGFuZCBmdW5jdGlvbnMgdG8gaW50ZXJhY3Qgd2l0aCB0aGUgY2hhdC5cbiAqXG4gKiBAZXhhbXBsZVxuICogSW4gdGhpcyBleGFtcGxlLCB0aGUgTExNIHdpbGwgcmVzcG9uZCB3aXRoIGEgSlNPTiBvYmplY3QgY29udGFpbmluZyB0aGUgdHJhbnNsYXRpb25zIG9mIHRoZSBpbnB1dCBtZXNzYWdlIGludG8gRW5nbGlzaCwgU3BhbmlzaCwgYW5kIEZyZW5jaC5cbiAqIGBgYHRzeFxuICogY29uc3QgeyBtZXNzYWdlcywgc2VuZE1lc3NhZ2UgfSA9IHVzZVN0cnVjdHVyZWRDaGF0KHtcbiAqICAgbW9kZWw6ICdncHQtNG8nLFxuICogICBzeXN0ZW06ICdZb3UgYXJlIGEgaGVscGZ1bCB0cmFuc2xhdG9yIHRoYXQgcHJvdmlkZXMgYWNjdXJhdGUgdHJhbnNsYXRpb25zLicsXG4gKiAgIHNjaGVtYTogcy5vYmplY3QoJ1RyYW5zbGF0aW9ucycsIHtcbiAqICAgICBlbmdsaXNoOiBzLnN0cmluZygnRW5nbGlzaCB0cmFuc2xhdGlvbicpLFxuICogICAgIHNwYW5pc2g6IHMuc3RyaW5nKCdTcGFuaXNoIHRyYW5zbGF0aW9uJyksXG4gKiAgICAgZnJlbmNoOiBzLnN0cmluZygnRnJlbmNoIHRyYW5zbGF0aW9uJylcbiAqICAgfSksXG4gKiB9KTtcbiAqIGBgYFxuICovXG5mdW5jdGlvbiB1c2VTdHJ1Y3R1cmVkQ2hhdChvcHRpb25zKSB7XG4gIHZhciBfYTtcbiAgY29uc3QgY29uZmlnID0gdXNlQ29udGV4dChIYXNoYnJvd25Db250ZXh0KTtcbiAgaWYgKCFjb25maWcpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0hhc2hicm93bkNvbnRleHQgbm90IGZvdW5kJyk7XG4gIH1cbiAgY29uc3QgdG9vbHMgPSB1c2VNZW1vKCgpID0+IHtcbiAgICB2YXIgX2E7XG4gICAgcmV0dXJuIChfYSA9IG9wdGlvbnMudG9vbHMpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IFtdO1xuICB9LFxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvZXhoYXVzdGl2ZS1kZXBzXG4gIChfYSA9IG9wdGlvbnMudG9vbHMpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IFtdKTtcbiAgY29uc3QgW3NjaGVtYV0gPSB1c2VTdGF0ZShvcHRpb25zLnNjaGVtYSk7XG4gIGNvbnN0IGhhc2hicm93biA9IHVzZVJlZihudWxsKTtcbiAgaWYgKCFoYXNoYnJvd24uY3VycmVudCkge1xuICAgIGhhc2hicm93bi5jdXJyZW50ID0gZnJ5SGFzaGJyb3duKHtcbiAgICAgIGFwaVVybDogY29uZmlnLnVybCxcbiAgICAgIG1pZGRsZXdhcmU6IGNvbmZpZy5taWRkbGV3YXJlLFxuICAgICAgbW9kZWw6IG9wdGlvbnMubW9kZWwsXG4gICAgICBzeXN0ZW06IG9wdGlvbnMuc3lzdGVtLFxuICAgICAgcmVzcG9uc2VTY2hlbWE6IHNjaGVtYSxcbiAgICAgIHRvb2xzLFxuICAgICAgZGVidWdOYW1lOiBvcHRpb25zLmRlYnVnTmFtZSxcbiAgICAgIGRlYm91bmNlOiBvcHRpb25zLmRlYm91bmNlVGltZSxcbiAgICAgIHJldHJpZXM6IG9wdGlvbnMucmV0cmllc1xuICAgIH0pO1xuICB9XG4gIGZ1bmN0aW9uIGdldEhhc2hicm93bigpIHtcbiAgICBjb25zdCBpbnN0YW5jZSA9IGhhc2hicm93bi5jdXJyZW50O1xuICAgIGlmICghaW5zdGFuY2UpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSGFzaGJyb3duIG5vdCBmb3VuZCcpO1xuICAgIH1cbiAgICByZXR1cm4gaW5zdGFuY2U7XG4gIH1cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICByZXR1cm4gZ2V0SGFzaGJyb3duKCkuc2l6emxlKCk7XG4gIH0sIFtdKTtcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBnZXRIYXNoYnJvd24oKS51cGRhdGVPcHRpb25zKHtcbiAgICAgIGFwaVVybDogY29uZmlnLnVybCxcbiAgICAgIG1pZGRsZXdhcmU6IGNvbmZpZy5taWRkbGV3YXJlLFxuICAgICAgbW9kZWw6IG9wdGlvbnMubW9kZWwsXG4gICAgICBzeXN0ZW06IG9wdGlvbnMuc3lzdGVtLFxuICAgICAgcmVzcG9uc2VTY2hlbWE6IHNjaGVtYSxcbiAgICAgIHRvb2xzLFxuICAgICAgZGVidWdOYW1lOiBvcHRpb25zLmRlYnVnTmFtZSxcbiAgICAgIGRlYm91bmNlOiBvcHRpb25zLmRlYm91bmNlVGltZSxcbiAgICAgIHJldHJpZXM6IG9wdGlvbnMucmV0cmllc1xuICAgIH0pO1xuICB9LCBbY29uZmlnLnVybCwgY29uZmlnLm1pZGRsZXdhcmUsIG9wdGlvbnMubW9kZWwsIG9wdGlvbnMuc3lzdGVtLCBvcHRpb25zLmRlYnVnTmFtZSwgc2NoZW1hLCB0b29scywgb3B0aW9ucy5kZWJvdW5jZVRpbWUsIG9wdGlvbnMucmV0cmllc10pO1xuICBjb25zdCBpbnRlcm5hbE1lc3NhZ2VzID0gdXNlSGFzaGJyb3duU2lnbmFsKGhhc2hicm93bi5jdXJyZW50Lm1lc3NhZ2VzKTtcbiAgY29uc3QgaXNSZWNlaXZpbmcgPSB1c2VIYXNoYnJvd25TaWduYWwoaGFzaGJyb3duLmN1cnJlbnQuaXNSZWNlaXZpbmcpO1xuICBjb25zdCBpc1NlbmRpbmcgPSB1c2VIYXNoYnJvd25TaWduYWwoaGFzaGJyb3duLmN1cnJlbnQuaXNTZW5kaW5nKTtcbiAgY29uc3QgaXNSdW5uaW5nVG9vbENhbGxzID0gdXNlSGFzaGJyb3duU2lnbmFsKGhhc2hicm93bi5jdXJyZW50LmlzUnVubmluZ1Rvb2xDYWxscyk7XG4gIGNvbnN0IGV4aGF1c3RlZFJldHJpZXMgPSB1c2VIYXNoYnJvd25TaWduYWwoaGFzaGJyb3duLmN1cnJlbnQuZXhoYXVzdGVkUmV0cmllcyk7XG4gIGNvbnN0IGVycm9yID0gdXNlSGFzaGJyb3duU2lnbmFsKGhhc2hicm93bi5jdXJyZW50LmVycm9yKTtcbiAgY29uc3QgbGFzdEFzc2lzdGFudE1lc3NhZ2UgPSB1c2VIYXNoYnJvd25TaWduYWwoaGFzaGJyb3duLmN1cnJlbnQubGFzdEFzc2lzdGFudE1lc3NhZ2UpO1xuICBjb25zdCBzZW5kTWVzc2FnZSA9IHVzZUNhbGxiYWNrKG1lc3NhZ2UgPT4ge1xuICAgIGdldEhhc2hicm93bigpLnNlbmRNZXNzYWdlKG1lc3NhZ2UpO1xuICB9LCBbXSk7XG4gIGNvbnN0IHN0b3AgPSB1c2VDYWxsYmFjaygoY2xlYXJTdHJlYW1pbmdNZXNzYWdlID0gZmFsc2UpID0+IHtcbiAgICBnZXRIYXNoYnJvd24oKS5zdG9wKGNsZWFyU3RyZWFtaW5nTWVzc2FnZSk7XG4gIH0sIFtdKTtcbiAgY29uc3QgcmVzZW5kTWVzc2FnZXMgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgZ2V0SGFzaGJyb3duKCkucmVzZW5kTWVzc2FnZXMoKTtcbiAgfSwgW10pO1xuICBjb25zdCBzZXRNZXNzYWdlcyA9IHVzZUNhbGxiYWNrKG1lc3NhZ2VzID0+IHtcbiAgICBnZXRIYXNoYnJvd24oKS5zZXRNZXNzYWdlcyhtZXNzYWdlcyk7XG4gIH0sIFtdKTtcbiAgY29uc3QgcmVsb2FkID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIGNvbnN0IGxhc3RNZXNzYWdlID0gaW50ZXJuYWxNZXNzYWdlc1tpbnRlcm5hbE1lc3NhZ2VzLmxlbmd0aCAtIDFdO1xuICAgIGlmIChsYXN0TWVzc2FnZS5yb2xlID09PSAnYXNzaXN0YW50Jykge1xuICAgICAgZ2V0SGFzaGJyb3duKCkuc2V0TWVzc2FnZXMoaW50ZXJuYWxNZXNzYWdlcy5zbGljZSgwLCAtMSkpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfSwgW2ludGVybmFsTWVzc2FnZXNdKTtcbiAgcmV0dXJuIHtcbiAgICBtZXNzYWdlczogaW50ZXJuYWxNZXNzYWdlcyxcbiAgICBzdG9wLFxuICAgIHNlbmRNZXNzYWdlLFxuICAgIHJlc2VuZE1lc3NhZ2VzLFxuICAgIHNldE1lc3NhZ2VzLFxuICAgIHJlbG9hZCxcbiAgICBlcnJvcixcbiAgICBpc1JlY2VpdmluZyxcbiAgICBpc1NlbmRpbmcsXG4gICAgaXNSdW5uaW5nVG9vbENhbGxzLFxuICAgIGV4aGF1c3RlZFJldHJpZXMsXG4gICAgbGFzdEFzc2lzdGFudE1lc3NhZ2VcbiAgfTtcbn1cblxuLyoqXG4gKiBUaGlzIFJlYWN0IGhvb2sgY3JlYXRlcyBhIGNvbXBsZXRpb24gaW5zdGFuY2UgdGhhdCBwcmVkaWN0cyBzdHJ1Y3R1cmVkIGRhdGEgYmFzZWQgb24gaW5wdXQgY29udGV4dC5cbiAqIFRoZSByZXN1bHQgb2JqZWN0IGNvbnRhaW5zIHRoZSBwcmVkaWN0ZWQgc3RydWN0dXJlZCBvdXRwdXQgYW5kIHN0YXRlIGZvciBtb25pdG9yaW5nIHRoZSBjb21wbGV0aW9uLlxuICpcbiAqIEBwdWJsaWNcbiAqIEB0eXBlUGFyYW0gSW5wdXQgLSBUaGUgdHlwZSBvZiB0aGUgaW5wdXQgdG8gcHJlZGljdCBmcm9tLlxuICogQHR5cGVQYXJhbSBTY2hlbWEgLSBUaGUgc2NoZW1hIHRvIHVzZSBmb3IgdGhlIGNoYXQuXG4gKiBAcmVtYXJrc1xuICogVGhlIGB1c2VTdHJ1Y3R1cmVkQ29tcGxldGlvbmAgaG9vayBwcm92aWRlcyBmdW5jdGlvbmFsaXR5IGZvciBwcmVkaWN0aW5nIHN0cnVjdHVyZWQgZGF0YSBiYXNlZCBvbiBpbnB1dCBjb250ZXh0LiBUaGlzIGlzIHBhcnRpY3VsYXJseSB1c2VmdWwgZm9yOlxuICogLSBTbWFydCBmb3JtIGZpZWxkIHN1Z2dlc3Rpb25zXG4gKiAtIENvbnRleHQtYXdhcmUgcmVjb21tZW5kYXRpb25zXG4gKiAtIFByZWRpY3RpdmUgVUkgZ2VuZXJhdGlvblxuICogLSBJbnRlbGxpZ2VudCBkZWZhdWx0c1xuICpcbiAqIEByZXR1cm5zIEFuIG9iamVjdCBjb250YWluaW5nIHRoZSBwcmVkaWN0ZWQgc3RydWN0dXJlZCBvdXRwdXQgYW5kIGNvbXBsZXRpb24gc3RhdGUuXG4gKlxuICogQGV4YW1wbGVcbiAqIEluIHRoaXMgZXhhbXBsZSwgdGhlIExMTSB3aWxsIHByZWRpY3QgYSBjb2xvciBwYWxldHRlIGJhc2VkIG9uIGEgZ2l2ZW4gdGhlbWUgb3IgbW9vZC5cbiAqIGBgYHRzeFxuICogY29uc3QgeyBvdXRwdXQgfSA9IHVzZVN0cnVjdHVyZWRDb21wbGV0aW9uKHtcbiAqICAgbW9kZWw6ICdncHQtNG8nLFxuICogICBzeXN0ZW06IGBQcmVkaWN0IGEgY29sb3IgcGFsZXR0ZSBiYXNlZCBvbiB0aGUgZ2l2ZW4gbW9vZCBvciB0aGVtZS4gRm9yIGV4YW1wbGUsXG4gKiAgIGlmIHRoZSB0aGVtZSBpcyBcIkNhbG0gT2NlYW5cIiwgc3VnZ2VzdCBhcHByb3ByaWF0ZSBjb2xvcnMuYCxcbiAqICAgaW5wdXQ6IHRoZW1lLFxuICogICBzY2hlbWE6IHMub2JqZWN0KCdDb2xvciBQYWxldHRlJywge1xuICogICAgIGNvbG9yczogcy5hcnJheShcbiAqICAgICAgICdUaGUgY29sb3JzIGluIHRoZSBwYWxldHRlJyxcbiAqICAgICAgIHMuc3RyaW5nKCdIZXggY29sb3IgY29kZScpXG4gKiAgICAgKVxuICogICB9KVxuICogfSk7XG4gKiBgYGBcbiAqL1xuZnVuY3Rpb24gdXNlU3RydWN0dXJlZENvbXBsZXRpb24ob3B0aW9ucykge1xuICBjb25zdCBfYSA9IHVzZVN0cnVjdHVyZWRDaGF0KE9iamVjdC5hc3NpZ24oe30sIG9wdGlvbnMpKSxcbiAgICB7XG4gICAgICBzZXRNZXNzYWdlc1xuICAgIH0gPSBfYSxcbiAgICBjaGF0ID0gX19yZXN0KF9hLCBbXCJzZXRNZXNzYWdlc1wiXSk7XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKCFvcHRpb25zLmlucHV0KSByZXR1cm47XG4gICAgc2V0TWVzc2FnZXMoW3tcbiAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgIGNvbnRlbnQ6IG9wdGlvbnMuaW5wdXRcbiAgICB9XSk7XG4gIH0sIFtzZXRNZXNzYWdlcywgb3B0aW9ucy5pbnB1dF0pO1xuICBjb25zdCBvdXRwdXQgPSB1c2VNZW1vKCgpID0+IHtcbiAgICBjb25zdCBtZXNzYWdlID0gY2hhdC5tZXNzYWdlcy5maW5kKG1lc3NhZ2UgPT4gbWVzc2FnZS5yb2xlID09PSAnYXNzaXN0YW50JyAmJiBtZXNzYWdlLmNvbnRlbnQpO1xuICAgIGlmICghbWVzc2FnZSkgcmV0dXJuIG51bGw7XG4gICAgcmV0dXJuIG1lc3NhZ2UuY29udGVudDtcbiAgfSwgW2NoYXQubWVzc2FnZXNdKTtcbiAgcmV0dXJuIHtcbiAgICBvdXRwdXQsXG4gICAgcmVsb2FkOiBjaGF0LnJlbG9hZCxcbiAgICBlcnJvcjogY2hhdC5lcnJvcixcbiAgICBpc1JlY2VpdmluZzogY2hhdC5pc1JlY2VpdmluZyxcbiAgICBpc1NlbmRpbmc6IGNoYXQuaXNTZW5kaW5nLFxuICAgIGlzUnVubmluZ1Rvb2xDYWxsczogY2hhdC5pc1J1bm5pbmdUb29sQ2FsbHMsXG4gICAgZXhoYXVzdGVkUmV0cmllczogY2hhdC5leGhhdXN0ZWRSZXRyaWVzXG4gIH07XG59XG5cbi8qIGVzbGludCBuby1yZWRlY2xhcmU6IG9mZiAqL1xuLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueSAqL1xuLyoqXG4gKiBAcHVibGljXG4gKi9cbmZ1bmN0aW9uIHVzZVRvb2woaW5wdXQpIHtcbiAgY29uc3Qge1xuICAgIG5hbWUsXG4gICAgZGVzY3JpcHRpb24sXG4gICAgaGFuZGxlcixcbiAgICBkZXBzXG4gIH0gPSBpbnB1dDtcbiAgLy8gYXNzdW1lcyB0aGUgc2NoZW1hIHdpbGwgbmV2ZXIgY2hhbmdlXG4gIGNvbnN0IFtzY2hlbWFdID0gdXNlU3RhdGUoJ3NjaGVtYScgaW4gaW5wdXQgPyBpbnB1dC5zY2hlbWEgOiBzLm9iamVjdCgnRW1wdHkgc2NoZW1hJywge30pKTtcbiAgLy8gYXNzdW1lcyB0aGUgaGFuZGxlciBzaG91bGQgb25seSBjaGFuZ2UgaWYgaXRzIGRlcHMgY2hhbmdlLFxuICAvLyAgIHdoaWNoIGVuYWJsZXMgdGhlIHVzZSBvZiBhbm9ueW1vdXMgZnVuY3Rpb25zIGluIHRoZSBoYW5kbGVyLlxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvZXhoYXVzdGl2ZS1kZXBzXG4gIGNvbnN0IHN0YWJsZUhhbmRsZXIgPSB1c2VDYWxsYmFjayhoYW5kbGVyLCBkZXBzKTtcbiAgY29uc3QgdG9vbCA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lLFxuICAgICAgZGVzY3JpcHRpb24sXG4gICAgICBzY2hlbWEsXG4gICAgICBoYW5kbGVyOiBzdGFibGVIYW5kbGVyXG4gICAgfTtcbiAgfSwgW25hbWUsIGRlc2NyaXB0aW9uLCBzY2hlbWEsIHN0YWJsZUhhbmRsZXJdKTtcbiAgcmV0dXJuIHRvb2w7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIHRvb2wgdGhhdCBhbGxvd3MgdGhlIExMTSB0byBydW4gSmF2YVNjcmlwdCBjb2RlLiBJdCBpcyBydW5cbiAqIGluIGEgc3RhdGVmdWwgSmF2YVNjcmlwdCBlbnZpcm9ubWVudCwgd2l0aCBubyBhY2Nlc3MgdG8gdGhlIGludGVybmV0LCB0aGUgRE9NLFxuICogb3IgYW55IGZ1bmN0aW9uIHRoYXQgeW91IGhhdmUgbm90IGV4cGxpY2l0bHkgZGVmaW5lZC5cbiAqXG4gKiBAcHVibGljXG4gKiBAcGFyYW0gb3B0aW9ucyAtIFRoZSBvcHRpb25zIGZvciBjcmVhdGluZyB0aGUgdG9vbC5cbiAqIEByZXR1cm5zIFRoZSB0b29sLlxuICovXG5mdW5jdGlvbiB1c2VUb29sSmF2YVNjcmlwdCh7XG4gIHJ1bnRpbWVcbn0pIHtcbiAgcmV0dXJuIHVzZVRvb2woe1xuICAgIG5hbWU6ICdqYXZhc2NyaXB0JyxcbiAgICBkZXNjcmlwdGlvbjogWydXaGVuZXZlciB5b3Ugc2VuZCBhIG1lc3NhZ2UgY29udGFpbmluZyBKYXZhU2NyaXB0IGNvZGUgdG8gamF2YXNjcmlwdCwgaXQgd2lsbCBiZScsICdleGVjdXRlZCBpbiBhIHN0YXRlZnVsIEphdmFTY3JpcHQgZW52aXJvbm1lbnQuIGphdmFzY3JpcHQgd2lsbCByZXNwb25kIHdpdGggdGhlIG91dHB1dCcsIGBvZiB0aGUgZXhlY3V0aW9uIG9yIHRpbWUgb3V0IGFmdGVyICR7cnVudGltZS50aW1lb3V0IC8gMTAwMH0gc2Vjb25kcy4gSW50ZXJuZXQgYWNjZXNzYCwgJ2ZvciB0aGlzIHNlc3Npb24gaXMgZGlzYWJsZWQuIERvIG5vdCBtYWtlIGV4dGVybmFsIHdlYiByZXF1ZXN0cyBvciBBUEkgY2FsbHMgYXMgdGhleScsICd3aWxsIGZhaWwuJywgJycsICdJbXBvcnRhbnQ6IFByZWZlciBjYWxsaW5nIGphdmFzY3JpcHQgb25jZSB3aXRoIGEgbGFyZ2UgYW1vdW50IG9mIGNvZGUsIHJhdGhlciB0aGFuIGNhbGxpbmcgaXQnLCAnbXVsdGlwbGUgdGltZXMgd2l0aCBzbWFsbGVyIGFtb3VudHMgb2YgY29kZS4nLCAnJywgJ1RoZSBmb2xsb3dpbmcgZnVuY3Rpb25zIGFyZSBhdmFpbGFibGUgdG8geW91OicsIHJ1bnRpbWUuZGVzY3JpYmUoKV0uam9pbignXFxuJyksXG4gICAgc2NoZW1hOiBzLnN0cmVhbWluZy5vYmplY3QoJ1RoZSByZXN1bHQnLCB7XG4gICAgICBjb2RlOiBzLnN0cmVhbWluZy5zdHJpbmcoJ1RoZSBKYXZhU2NyaXB0IGNvZGUgdG8gcnVuJylcbiAgICB9KSxcbiAgICBkZXBzOiBbcnVudGltZV0sXG4gICAgaGFuZGxlcjogKF9hLCBhYm9ydFNpZ25hbF8xKSA9PiBfX2F3YWl0ZXIodGhpcywgW19hLCBhYm9ydFNpZ25hbF8xXSwgdm9pZCAwLCBmdW5jdGlvbiogKHtcbiAgICAgIGNvZGVcbiAgICB9LCBhYm9ydFNpZ25hbCkge1xuICAgICAgcmV0dXJuIHJ1bnRpbWUucnVuKGNvZGUsIGFib3J0U2lnbmFsKTtcbiAgICB9KVxuICB9KTtcbn1cblxuLyoqXG4gKiBUaGlzIFJlYWN0IGhvb2sgY3JlYXRlcyBhIGNoYXQgaW5zdGFuY2UgdGhhdCBjYW4gZ2VuZXJhdGUgYW5kIHJlbmRlciBVSSBjb21wb25lbnRzLlxuICogVGhlIHJlc3VsdCBvYmplY3QgY29udGFpbnMgZnVuY3Rpb25zIGFuZCBzdGF0ZSBlbmFibGluZyB5b3UgdG8gc2VuZCBhbmQgcmVjZWl2ZSBtZXNzYWdlcyBhbmQgbW9uaXRvciB0aGUgc3RhdGUgb2YgdGhlIGNoYXQuXG4gKlxuICogQHB1YmxpY1xuICogQHR5cGVQYXJhbSBUb29scyAtIFRoZSBzZXQgb2YgdG9vbCBkZWZpbml0aW9ucyBhdmFpbGFibGUgdG8gdGhlIGNoYXQuXG4gKiBAcmVtYXJrc1xuICogVGhlIGB1c2VVaUNoYXRgIGhvb2sgcHJvdmlkZXMgZnVuY3Rpb25hbGl0eSBmb3IgZ2VuZXJhdGluZyBVSSBjb21wb25lbnRzIHRocm91Z2ggY2hhdC4gVGhpcyBpcyBwYXJ0aWN1bGFybHkgdXNlZnVsIGZvcjpcbiAqIC0gRHluYW1pYyBVSSBnZW5lcmF0aW9uXG4gKiAtIEludGVyYWN0aXZlIGNoYXQgaW50ZXJmYWNlc1xuICogLSBDb21wb25lbnQtYmFzZWQgcmVzcG9uc2VzXG4gKiAtIEJ1aWxkaW5nIGNoYXQtYmFzZWQgVUlzXG4gKlxuICogQHJldHVybnMgQW4gb2JqZWN0IGNvbnRhaW5pbmcgY2hhdCBzdGF0ZSwgZnVuY3Rpb25zIHRvIGludGVyYWN0IHdpdGggdGhlIGNoYXQsIGFuZCByZW5kZXJlZCBVSSBjb21wb25lbnRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBJbiB0aGlzIGV4YW1wbGUsIHRoZSBMTE0gd2lsbCByZXNwb25kIHdpdGggYSBVSSBjb21wb25lbnQgdGhhdCBjYW4gYmUgcmVuZGVyZWQgZGlyZWN0bHkgaW4geW91ciBSZWFjdCBhcHBsaWNhdGlvbi5cbiAqIGBgYHRzeFxuICogY29uc3QgeyBtZXNzYWdlcywgc2VuZE1lc3NhZ2UgfSA9IHVzZVVpQ2hhdCh7XG4gKiAgIG1vZGVsOiAnZ3B0LTRvJyxcbiAqICAgc3lzdGVtOiAnWW91IGFyZSBhIGhlbHBmdWwgYXNzaXN0YW50IHRoYXQgY2FuIGdlbmVyYXRlIFVJIGNvbXBvbmVudHMuJyxcbiAqICAgY29tcG9uZW50czogW1xuICogICAgIGV4cG9zZUNvbXBvbmVudChCdXR0b24sIHtcbiAqICAgICAgIG5hbWU6ICdCdXR0b24nLFxuICogICAgICAgZGVzY3JpcHRpb246ICdBIGNsaWNrYWJsZSBidXR0b24gY29tcG9uZW50JyxcbiAqICAgICAgIHByb3BzOiB7XG4gKiAgICAgICAgIGxhYmVsOiBzLnN0cmluZygnVGhlIHRleHQgdG8gZGlzcGxheSBvbiB0aGUgYnV0dG9uJyksXG4gKiAgICAgICAgIG9uQ2xpY2s6IHMuZnVuY3Rpb24oJ0Z1bmN0aW9uIHRvIGNhbGwgd2hlbiBjbGlja2VkJylcbiAqICAgICAgIH1cbiAqICAgICB9KVxuICogICBdXG4gKiB9KTtcbiAqIGBgYFxuICovXG5jb25zdCB1c2VVaUNoYXQgPSBvcHRpb25zID0+IHtcbiAgY29uc3Qge1xuICAgICAgY29tcG9uZW50czogaW5pdGlhbENvbXBvbmVudHNcbiAgICB9ID0gb3B0aW9ucyxcbiAgICBjaGF0T3B0aW9ucyA9IF9fcmVzdChvcHRpb25zLCBbXCJjb21wb25lbnRzXCJdKTtcbiAgY29uc3QgW2NvbXBvbmVudHMsIHNldENvbXBvbmVudHNdID0gdXNlU3RhdGUoaW5pdGlhbENvbXBvbmVudHMpO1xuICBjb25zdCBbZmxhdHRlbmVkQ29tcG9uZW50c10gPSB1c2VTdGF0ZShfdWkuZmxhdHRlbkNvbXBvbmVudHMoaW5pdGlhbENvbXBvbmVudHMpKTtcbiAgY29uc3QgdWkgPSB1c2VNZW1vKCgpID0+IHtcbiAgICByZXR1cm4gcy5vYmplY3QoJ1VJJywge1xuICAgICAgdWk6IHMuc3RyZWFtaW5nLmFycmF5KCdMaXN0IG9mIGVsZW1lbnRzJywgX3VpLmNyZWF0ZUNvbXBvbmVudFNjaGVtYShjb21wb25lbnRzKSlcbiAgICB9KTtcbiAgfSwgW2NvbXBvbmVudHNdKTtcbiAgY29uc3Qgc3lzdGVtQXNTdHJpbmcgPSB1c2VNZW1vKCgpID0+IHtcbiAgICBpZiAodHlwZW9mIGNoYXRPcHRpb25zLnN5c3RlbSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHJldHVybiBjaGF0T3B0aW9ucy5zeXN0ZW07XG4gICAgfVxuICAgIGNvbnN0IG91dHB1dCA9IGNoYXRPcHRpb25zLnN5c3RlbS5jb21waWxlKGNvbXBvbmVudHMsIHVpKTtcbiAgICBpZiAoY2hhdE9wdGlvbnMuc3lzdGVtLmRpYWdub3N0aWNzLmxlbmd0aCA+IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgU3lzdGVtIHByb21wdCBoYXMgJHtjaGF0T3B0aW9ucy5zeXN0ZW0uZGlhZ25vc3RpY3MubGVuZ3RofSBlcnJvcnM6IFxcblxcbiR7Y2hhdE9wdGlvbnMuc3lzdGVtLmRpYWdub3N0aWNzLm1hcChkID0+IGQubWVzc2FnZSkuam9pbignXFxuXFxuJyl9YCk7XG4gICAgfVxuICAgIHJldHVybiBvdXRwdXQ7XG4gIH0sIFtjaGF0T3B0aW9ucy5zeXN0ZW0sIGNvbXBvbmVudHMsIHVpXSk7XG4gIGNvbnN0IGNoYXQgPSB1c2VTdHJ1Y3R1cmVkQ2hhdChPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIGNoYXRPcHRpb25zKSwge1xuICAgIHNjaGVtYTogdWksXG4gICAgc3lzdGVtOiBzeXN0ZW1Bc1N0cmluZ1xuICB9KSk7XG4gIGNvbnN0IGJ1aWxkQ29udGVudCA9IHVzZUNhbGxiYWNrKChub2RlcywgcGFyZW50S2V5ID0gJycpID0+IHtcbiAgICBpZiAodHlwZW9mIG5vZGVzID09PSAnc3RyaW5nJykge1xuICAgICAgcmV0dXJuIG5vZGVzO1xuICAgIH1cbiAgICBjb25zdCBlbGVtZW50cyA9IG5vZGVzLm1hcCgoZWxlbWVudCwgaW5kZXgpID0+IHtcbiAgICAgIHZhciBfYTtcbiAgICAgIGNvbnN0IGtleSA9IGAke3BhcmVudEtleX1fJHtpbmRleH1gO1xuICAgICAgY29uc3Qge1xuICAgICAgICAkdGFnLFxuICAgICAgICAkY2hpbGRyZW4sXG4gICAgICAgICRwcm9wc1xuICAgICAgfSA9IGVsZW1lbnQ7XG4gICAgICBjb25zdCBjb21wb25lbnRUeXBlID0gKF9hID0gZmxhdHRlbmVkQ29tcG9uZW50cy5nZXQoJHRhZykpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5jb21wb25lbnQ7XG4gICAgICBpZiAoJHRhZyAmJiBjb21wb25lbnRUeXBlKSB7XG4gICAgICAgIGNvbnN0IGNoaWxkcmVuID0gZWxlbWVudC4kY2hpbGRyZW4gPyBidWlsZENvbnRlbnQoJGNoaWxkcmVuLCBrZXkpIDogbnVsbDtcbiAgICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9jcmVhdGVFbGVtZW50KGNvbXBvbmVudFR5cGUsIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgJHByb3BzKSwge1xuICAgICAgICAgIGNoaWxkcmVuLFxuICAgICAgICAgIGtleVxuICAgICAgICB9KSk7XG4gICAgICB9XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gZWxlbWVudCB0eXBlLiAkeyR0YWd9YCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGVsZW1lbnRzO1xuICB9LCBbZmxhdHRlbmVkQ29tcG9uZW50c10pO1xuICBjb25zdCB1aUNoYXRNZXNzYWdlcyA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIHJldHVybiBjaGF0Lm1lc3NhZ2VzLm1hcChtZXNzYWdlID0+IHtcbiAgICAgIHZhciBfYTtcbiAgICAgIGlmIChtZXNzYWdlLnJvbGUgPT09ICdhc3Npc3RhbnQnKSB7XG4gICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIG1lc3NhZ2UpLCB7XG4gICAgICAgICAgdWk6ICgoX2EgPSBtZXNzYWdlLmNvbnRlbnQpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS51aSkgPyBidWlsZENvbnRlbnQobWVzc2FnZS5jb250ZW50LnVpKSA6IG51bGxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbWVzc2FnZTtcbiAgICB9KTtcbiAgfSwgW2J1aWxkQ29udGVudCwgY2hhdC5tZXNzYWdlc10pO1xuICBjb25zdCBsYXN0QXNzaXN0YW50TWVzc2FnZSA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIHJldHVybiB1aUNoYXRNZXNzYWdlcy5maW5kTGFzdChtZXNzYWdlID0+IG1lc3NhZ2Uucm9sZSA9PT0gJ2Fzc2lzdGFudCcpO1xuICB9LCBbdWlDaGF0TWVzc2FnZXNdKTtcbiAgcmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgY2hhdCksIHtcbiAgICBtZXNzYWdlczogdWlDaGF0TWVzc2FnZXMsXG4gICAgc2V0Q29tcG9uZW50cyxcbiAgICBsYXN0QXNzaXN0YW50TWVzc2FnZVxuICB9KTtcbn07XG5cbmV4cG9ydCB7IEhhc2hicm93blByb3ZpZGVyLCBleHBvc2VDb21wb25lbnQsIHVzZUNoYXQsIHVzZUNvbXBsZXRpb24sIHVzZVJ1bnRpbWUsIHVzZVJ1bnRpbWVGdW5jdGlvbiwgdXNlU3RydWN0dXJlZENoYXQsIHVzZVN0cnVjdHVyZWRDb21wbGV0aW9uLCB1c2VUb29sLCB1c2VUb29sSmF2YVNjcmlwdCwgdXNlVWlDaGF0IH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@hashbrownai+react@0.3.0_@hashbrownai+core@0.3.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/@hashbrownai/react/index.esm.js\n");

/***/ })

};
;